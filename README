gencfg

A trafgen configuration generation and syntax testing tool

* Generate premade and customizable packet generations
* Apply byte separators to test syntax after changes to the lex parser
* Convert input file to trafgen packet configuration
 
TODO (not ranked) [~~DONE~~]:

1. More packet configs
2. ~~Fix endwhite separator, now noendwhite~~
3. Apply separators consistently
4. Create RFC2544 packet configurations
5. More configurable beacon frame fields
6. Write function to check for trafgen and netsniff-ng
7. Add NST packet configs.
8. Add config addressed in ip frag patch to linux kernel
 
USAGE:

Usage: ./gencfg -G <packet type> -S <separator> [-o out.txt]

Non-Mandatory Options:

-o write output to file e.g. -o packet.cfg
-S byte separator "comma/white/endwhite/noendcomma" e.g.

Write configurations to a file or redirect to trafgen e.g.
./gencfg ... | trafgen --in - --out

PACKET CONFIGURATION:

Generate built-in packet configurations ( -G <packet type> ).

Supported types:

beacon - Generation of 802.11 beacon frames. For proper byte alignment
choose an SSID of 8 alpha-numeric characters ( -T "FreeWifi" ). Random
generation of 8 characters via /dev/urandom can be done automatically
( -T random ) and the number of random SSID beacon generations can be
chosen ( -n 1000 ). Other configurable option includes specifying the
source MAC address ( -m 00:11:22:aa:bb:cc ).
./gencfg -G beacon -T "FreeWifi" -m 00:11:22:aa:bb:cc

syslog - Generate a syslog packet configuration. Configurable options
include source MAC, destination MAC, source IP, and destination IP.
./gencfg -G syslog -s 10.1.1.1 -d 10.1.1.2 \
-m de:ad:be:ef:00:00 -M 00:0c:29:8d:4d:a2

CONVERSION:

-c Convert C array of bytes exported from Wireshark. e.g. -c carray.txt
-p Convert PCAP (requires netsniff-ng) to trafgen config e.g. -p example.pcap
 
EXAMPLES:

./gencfg -c array.txt -S comma | trafgen --in - --out eth0 --num 100
./gencfg -G syslog -s 10.1.1.1 -d 10.1.1.2 -M 00:0c:29:8d:4d:a2 -S white
./gencfg -G beacon -T random -n 1000 -m de:ad:be:ef:00:00 -o beacon.cfg
./gencfg -G beacon -T "FreeWifi" -o beacon.cfg | trafgen --in - --out wlan0 --rfraw --num 1000

AUTHOR: Jon Schipp (keisterstash)
WEB: sickbits.net, jonschipp.com
E-MAIL: jonschipp [ at ] Gmail dot com
